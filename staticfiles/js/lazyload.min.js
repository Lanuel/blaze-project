document.addEventListener("DOMContentLoaded", function () {
    // Initialize lazy loading
    const lazyLoadInstance = new LazyLoad({
        elements_selector: "img.lazy",
        threshold: 100,
        callback_loaded: (img) => {
            img.classList.remove("lazy");
            // Add fade-in effect
            img.style.opacity = 0;
            img.style.transition = "opacity 0.3s ease-in";
            requestAnimationFrame(() => {
                img.style.opacity = 1;
            });
        },
        use_native: true
    });

    // Fallback for older browsers without IntersectionObserver
    if (!('IntersectionObserver' in window)) {
        const lazyImages = document.querySelectorAll("img.lazy");
        lazyImages.forEach(img => {
            if (img.dataset.src) {
                img.src = img.dataset.src;
            }
            img.classList.remove("lazy");
        });
    }
});
